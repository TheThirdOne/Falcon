<html>
  <head>
    
  </head>
  <body>
    <form enctype="multipart/form-data" action="/create" id="form">
        <div id="name">Name: <input type="text" name="name" required></div>
        <div id="dest">Destination:<input type="text" name="destination" required></div>
        <div id="quantity">Quantity:<input type="text" name="quantity" required></div>
        <div id="type">Type:<select name="type"></select></div>
        <div id="thread">Thread:<input type="text" name="thread"></div>
        <div id="loc">Location:<input type="text" name="location" required></div>
        <div id="image">Image: <input type="file" name="file" id="file" required></div>
        <input type="submit" value="Submit">
    </form>
    <form method="get" enctype="multipart/form-data" action="/get" id="getter">
        <div id="uni-bar">Search: <input type="text" name="uni-bar" required></div>
        <input type="submit" value="Submit">
    </form>
    <div id="results"></div>
    
    <script>
    document.getElementById("form").onsubmit=function() {
      var data = new FormData(document.getElementById("form"));
      var request = new XMLHttpRequest();
      request.open("POST", "/create");
      request.send(data);
      return false;
    };
    document.getElementById("getter").onsubmit=function() {
      var data = new FormData();
      var str = document.getElementById("uni-bar").childNodes[1].value,t;
      console.log(str);
      str = str.split(' ');
      for(var i = 0; i < str.length;i++){
        console.log(str[i]);
        if(str[i].indexOf(':')!==-1){
           t = str[i].split(':');
           console.log(t);
           data.append(t[0],t[1]);
        }
      }
      var request = new XMLHttpRequest();
      request.open("POST", "/get");
      
      request.onload = function(){
        var res = JSON.parse(this.responseText);
        var out = '';
        for(var i = 0; i < res.length;i++){
          out += '<img height="128" width="128" src="' + res[i].image + '"></img>'
        }
        document.getElementById("results").innerHTML = out;
      }
      request.send(data);
      return false;
    };
    function make(selector,values,tohide){
      var t;
      for(var i = 0;i<values.length;i++){
        t=document.createElement('option');
        t.innerText = values[i];
        selector.appendChild(t);
      }
      selector.onchange = function(){
        for(var i = 0;i<values.length;i++){
          if(selector.value !== values[i]){
            tohide[i].style.display = 'none';
            tohide[i].style.visibility = 'hidden';
          }else{
            tohide[i].style.display = '';
            tohide[i].style.visibility = '';
          }
        }
      }
    }
    function selectorToNode(sel){
      var out = [];
      for(var i = 0; i < sel.length; i++){
        if(sel[i])
          out[i]=document.getElementById(sel[i]);
        else
          out[i]=document.createElement('div');
      }
      return out;
    }
    make(document.getElementsByTagName('select')[0],['Bolt','Nail','U-Channel'],selectorToNode(['thread','','']));
    </script>
  </body>
</html>